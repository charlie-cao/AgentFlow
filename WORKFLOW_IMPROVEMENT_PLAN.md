# AI 工作流生成功能全面改进计划

## 用户需求分析

1. ✅ **通过 AI 生成提示词自动化创建工作流** - 需要改进提示词
2. ✅ **在编辑器中正确显示** - 需要修复节点格式转换
3. ✅ **Agent 通过大模型生成和设置** - 需要添加 Agent 配置功能
4. ✅ **运行所有模型（并发）** - 需要支持并发执行
5. ✅ **调试面板显示所有模型输出** - 需要改进 ExecutionMonitor
6. ✅ **支持并发执行** - 需要修改执行器

## 当前问题

### 1. 提示词问题
- 提示词不够详细，无法生成正确的 JSON 格式
- 缺少具体的数据结构示例
- 没有明确要求生成 ReactFlow 兼容格式

### 2. 节点格式转换问题
- 生成的工作流节点格式可能与 ReactFlow 不兼容
- 缺少必要的字段（如 triggerType 等）

### 3. 执行方式问题
- 当前是串行执行（按顺序）
- 需要支持并发执行所有 Agent 节点

### 4. SSE 广播问题
- SSE 系统没有真正实现广播功能
- 执行事件没有通过 SSE 发送

### 5. 调试面板问题
- 可能无法正确显示所有模型输出
- 需要更好的实时更新

## 改进方案

### 阶段 1: 改进提示词和工作流生成
- 提供详细的 JSON 结构示例
- 明确要求生成 ReactFlow 兼容格式
- 改进错误处理和 JSON 解析

### 阶段 2: 支持并发执行
- 修改执行器支持并发执行 Agent 节点
- 实现依赖关系检测
- 支持并行执行无依赖的节点

### 阶段 3: 改进 SSE 和调试面板
- 实现真正的 SSE 广播系统
- 改进调试面板显示所有输出
- 支持实时更新

### 阶段 4: Agent 配置功能
- 添加 Agent 节点编辑器
- 支持通过 AI 生成 Agent 配置
- 支持手动配置 Agent

## 实施步骤

1. ✅ 改进 AI 提示词
2. ✅ 修复节点格式转换
3. ✅ 实现并发执行
4. ✅ 改进 SSE 广播
5. ✅ 改进调试面板
6. ✅ 添加 Agent 配置功能

