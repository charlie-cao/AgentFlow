# AI 工作流功能需求清单

## 用户需求总结

根据用户要求，需要实现以下功能：

### 1. AI 生成工作流（通过提示词）
- ✅ 改进提示词，使其能生成正确格式的 JSON
- ✅ 支持自动化创建工作流
- ⚠️ 需要确保生成的工作流能在编辑器中正确显示

### 2. 编辑器显示
- ✅ 工作流节点能在 ReactFlow 编辑器中正确显示
- ✅ 支持拖拽、连接等操作

### 3. Agent 配置
- ⚠️ 支持通过大模型生成 Agent 配置
- ⚠️ 支持在编辑器中设置 Agent 参数
- ⚠️ 每个 Agent 都有独立的提示词和配置

### 4. 并发执行
- ❌ **当前是串行执行，需要改为并发**
- ⚠️ 所有 Agent 节点应该同时运行（如果无依赖关系）
- ⚠️ 需要支持依赖关系检测

### 5. 调试面板
- ⚠️ 显示所有模型的输出
- ⚠️ 实时更新执行状态
- ⚠️ 显示每个 Agent 的提示词和响应

### 6. 所有模型运行
- ⚠️ 确保所有 Agent 节点都会执行
- ⚠️ 支持并行执行多个 Agent

## 当前状态

- ✅ 基础工作流生成功能已实现
- ✅ 基础执行功能已实现
- ⚠️ 提示词需要改进
- ❌ **缺少并发执行支持**
- ⚠️ SSE 广播系统不完整
- ⚠️ 调试面板需要改进

## 需要实施的改进

### 优先级 1: 并发执行
- 修改 WorkflowExecutor 支持并发执行
- 实现依赖关系分析
- 支持并行执行无依赖的 Agent 节点

### 优先级 2: SSE 广播
- 实现真正的 SSE 广播系统
- 将所有执行事件广播给用户
- 确保调试面板能实时接收更新

### 优先级 3: 改进提示词
- 优化提示词使其生成更准确的工作流
- 添加 JSON 格式示例
- 改进错误处理

### 优先级 4: Agent 配置
- 添加 Agent 节点编辑器
- 支持 AI 生成 Agent 配置
- 支持手动配置

